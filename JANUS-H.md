# JANUS-H: 폐쇄망 전략적 침투 대응을 위한 계층형 판단 기반 보안 아키텍처 설계

##  프로젝트 개요

**JANUS-H**는 전략적 침투를 허용한 뒤, 다단계 판단 체계를 기반으로 이상행동을 분석하고 판단하는 **계층형 분산 보안 아키텍처**이다.  
JANUS에서 진화된 버전으로 다음과 같은 핵심 특징을 가진다:

- **수직 분산 판단 구조**: 말단-중간-중앙 설계자 계층
- **Trust Score 기반 점수 분기 + Override 판단 로직**
- **디지털 트윈 기반 격리 + Fake DB**
- **SHA-256 기반 블록체인 로그**
- **설계자 Karma 점수 시스템 및 Decoy 설계자**
- **LSTM 이상행동 분석 + GPT 기반 판단보조 리포트**
- **시뮬레이터 기반 판단 히스토리 학습 시스템**
- **KARMA 기반 설계자 등급제 및 권한 제어 시스템**
- 
---

## 0. 초록 (Abstract)
고도화된 사이버 위협 환경에서 기존 폐쇄망 보안 체계는 침입 자체의 차단에 집중해 왔으나, 내부자 위협과 우회 공격의 증가로 인해 근본적인 한계를 드러내고 있다. 본 문서는 침입 이후 대응을 핵심으로 삼는 전략적 보안 아키텍처, JANUS-H를 제안한다. 본 구조는 인간 설계자의 판단을 중심으로, 블록체인 기반 로그 무결성, 생체 인증, 나노 환경 분석, 프라이빗 블록체인, AI 자동화 탐지 등 다중 보안 기술을 통합한 계층형 판단 체계이다. JANUS-H는 단순 차단이 아닌 유도-분석-격리-복구를 중심으로, 폐쇄망 환경 내 지속 가능한 보안 아키텍처를 설계한다.

---

## 1. 서론 (Introduction)
### 1.1 배경 및 문제 인식
- 폐쇄망 환경(국가 기반 시설, 군사 시스템 등)은 외부 인터넷과 단절된 특성상 보안성이 높다고 여겨졌으나, 내부자 위협, USB 매개 침투, 관리자의 판단 오류 등으로 인해 침입 이후 피해가 발생하는 사례가 지속되고 있음.
- 기존 보안 구조는 '침입 차단'에 초점을 맞췄으나, 실질적으로는 '침입 이후 대응'이 핵심이 되어야 함.

### 1.2 제안 아키텍처 개요
- 판단 주체를 시스템이 아닌 인간 '설계자'로 이관하여 보안 의사결정의 통제권을 확보함.
- 다중 설계자 구조로 판단을 수직적으로 분산하며, 신뢰 점수 및 KARMA 기반의 판단 통제 체계를 도입함.
- 공격자를 격리하고 분석할 수 있는 샌드박스 환경(Fake DB, 디지털 트윈), 그리고 로그 무결성을 위한 블록체인 시스템과 AI 이상탐지 자동화를 통합함.

---

## 2. 아키텍처 구조 및 흐름

### 2.1 전체 구성 흐름도
```
┌───────────────────────────────────────────────┐
│ 사용자 행동 로그 수집 (클릭, IP, 생체, 환경) │
└───────────────────────────────────────────────┘
                ↓
┌────────────────────────────────┐
│ 블록체인 기반 로그 저장 (RAFT) │
└────────────────────────────────┘
                ↓
┌──────────────────────────────┐
│ AI 분석 및 Trust Score 계산 │
└──────────────────────────────┘
                ↓
┌────────────────────────────┐
│ 이상 탐지 시 디지털 트윈 격리 │
└────────────────────────────┘
                ↓
┌────────────────────────────────────────────┐
│ 설계자 판단: 복귀 / 격리 유지 / 봉쇄 / Override │
└────────────────────────────────────────────┘
                ↓
┌────────────────────────────────┐
│ 로그 추적 + KARMA 점수 누적 기록 │
└────────────────────────────────┘
```
- 주요 흐름: 사용자 요청 → 이상행동 탐지 → 설계자 판단 → 격리 여부 결정 → Fake DB 전환/복귀/봉쇄 → 리포트 분석

### 2.2 핵심 개념 요약
- 설계자 판단 구조 (분산 판단 + Override 가능)
- 신뢰 점수 기반 분기 시스템
- 블록체인 로그 무결성
- 디지털 트윈 격리 환경
- 생체 인증 + 나노 센서 기반 로그 보강
- AI 기반 리포트 자동 분석

---
---

## 3. 핵심 기술 구성 상세

### 3.1 판단자 계층 구조

| 계층        | 구성 예시              | 역할 설명                                                   |
|-------------|------------------------|--------------------------------------------------------------|
| 말단 설계자 | 부서별 판단 인스턴스    | 실시간 판단 / 자동화 판단 보조 / 빠른 감지 및 격리                |
| 중간 설계자 | 부서장, 시스템 관리자   | 판단 요약 확인 / Override 일부 가능 / 통계 분석 담당           |
| 중앙 설계자 | 보안 통합 책임 관리자   | 전체 통합 판단 / Override 최종 결정 / 설계자 감시 기능 보유      |

#### 3.1.1 수직 분산 설계자 구조
- 판단자는 단일 설계자가 아니라, 계층적 구조를 지닌 복수 설계자로 구성됨.
- 판단자는 KARMA 점수 및 신뢰도에 따라 상하 계층이 나뉘며, 판단 충돌 시 Override 구조로 상위 판단자가 최종 결정함.

### 설계자 등급제 및 판단 권한 구조

| 등급 | 권한 | 예시 역할 |
|------|------|-----------|
| L1 | Override 가능, 모든 로그 접근, 격리/복귀 최종 판단 | 최고 책임 설계자 (예: 사령관) |
| L2 | 격리/복귀 판단, 로그 열람, 일부 Override 제한 | 중간 관리자 (예: 작전장교) |
| L3 | 로그 분석, AI 리포트 확인, 격리 제안 | 보안 요원, AI 분석가 |

- **로그 접근 제한**: 상위 설계자만 특정 로그 접근 가능 (e.g., 설계자 Karma 로그)

#### 3.1.2 설계자 Override 로직
- 특정 판단에 대해 판단자 A와 B가 서로 다른 결론을 낼 경우, 더 높은 KARMA 점수를 보유한 상위 설계자가 Override 가능.
- 모든 Override 기록은 블록체인 로그에 저장됨. 예:
  - `설계자 B → 격리 미결정`
  - `설계자 A(상위) → Override: 격리 수행`
  - `해시: abc123, 타임스탬프: 2025-05-29 13:40`

#### 3.1.3 KARMA 시스템
- 판단자의 행동은 KARMA 점수에 영향을 미침:
  - 올바른 판단: +점수
  - 오판, 판단 지연: -점수
- 특정 점수 이하 시 판단권 제한

---

### 3.2 Trust Score 흐름

- 초기 점수: 1000점
- 감점 조건: 빠른 클릭 / 반복 API / 직접 URL 접근 / 로그인 시도 반복
- 상태 전이: **정상 → 감시 → 격리 후보 → 격리**
- 신뢰 회복: 설계자 판단에 따라만 회복 가능 (자동 회복 없음)


### 3.3 생체 인증 구조

- 생체 인증은 설계자의 판단 및 로그 접근 시 반드시 요구됨.
- 지문, 망막 등 복제 불가능한 데이터를 통해 설계자의 행위와 기록을 1:1로 연결.
- 예:
  - `로그 기록 요청 → 설계자 A 지문 인증 → 로그 #124 기록`

- AI 기반 인증 오류 감지 가능 (예: 패턴 이상 시 탐지율 90% 목표)

---

### 3.4 프라이빗 블록체인 로그 구조

#### 3.4.1 네트워크 구조
- 5~10개의 노드(군사 서버)를 통해 폐쇄망 내 프라이빗 블록체인 구성
- 리더 노드와 팔로워 노드로 구분, RAFT 합의 알고리즘 기반으로 블록 생성

#### 3.4.2 블록 구조
- Header: 이전 블록 해시, 타임스탬프, 현재 해시
- Body:
  - 로그 이벤트: 예) 로그인 실패 5회
  - 생체 인증 결과
  - 환경 센서(나노) 데이터
- AES-256 암호화 및 TLS 1.3 통신 적용

---

### 3.5 나노 센서 기반 환경 이상 탐지

- 서버실 내 온도/습도/기압 등 환경 값 측정
- 기준값(예: 온도 22°C ±2°C) 벗어날 경우 이상 탐지
- 로그 조작 시점과 현재 환경이 불일치 → 조작 의심

- 예:
  - `로그 #125: 온도 22°C`
  - `현재 온도: 30°C` → 조작 가능성 90% 이상

---

### 3.6 AI 자동 리포트 및 다크데이터

- 사용자의 마우스 동선, 클릭 좌표, 키 입력 속도 등을 수집
- LSTM 기반 이상행동 탐지 알고리즘 적용
- 설계자는 자동 생성된 리포트를 참고하여 격리/복구 판단 수행

---

### 3.7 디지털 트윈 기반 격리 환경

- 격리된 사용자는 실제 서비스와 유사한 Fake 환경에 진입
- Fake DB는 실시간 원본 DB를 복사하되, 민감정보는 가공됨
- 격리 사용자 행위는 정밀 로그 및 영상 기록됨

### Decoy Architect (가짜 설계자) 구조

- **개념**: 공격자가 설계자 계정 탈취 시, 의도적으로 가짜 권한 부여
- **동작 원리**:
  1. 탈취된 계정 → Decoy Architect 권한 부여
  2. 실제 로그 및 시스템에 접근하는 것처럼 보임
  3. 모든 활동 fake.db 및 디지털 트윈 상에서 이뤄짐
  4. 모든 행동 로그 정밀 수집 및 추적

- **목적**:
  - 공격자 식별
  - 법적 증거 수집
  - 실제 시스템 피해 방지

- **예시 로그**:
  ```
  [Decoy Architect] 2025-05-30 12:03 | 로그 #325 수정 시도
  [AI] 환경 불일치 감지 → 의심점수 +80
  ```
---
---

## 4. 침입 시나리오 기반 판단 흐름 예시

### 4.1 시나리오 A: 내부자 관리자 계정 탈취 및 로그 위조 시도

- **상황**: 해커가 내부자의 계정(ID/PW) 탈취 후 관리자 페이지 접근
- **시나리오 흐름**:
  1. 해커가 로그인 시도 → 성공
  2. 로그인 후 관리자 페이지 진입 → 빠른 클릭 / 특정 메뉴 단독 접근
  3. 로그 위조 시도 → 생체 인증 요구 발생
  4. 생체 인증 실패 → 격리 모듈 발동
  5. 디지털 트윈 환경으로 격리 → fake.db로 연결
  6. AI 리포트 자동 생성 → 설계자에게 전송
  7. 설계자 판단 → 격리 유지 or 복귀 or 완전 봉쇄 결정

- **결과**: 실제 원본 DB 및 서비스는 영향 없음

---

## 5. 수식 및 탐지 로직

### 5.1 Trust Score 계산 수식

```
TrustScore = BaseScore - (Σ 감점요소) + (Σ 회복점수)
```

- BaseScore = 1000
- 감점요소 예시:
  - 빠른 클릭 (100ms 이하): -50
  - 비정상 IP 접속: -100
  - 인증 실패 반복: -150
- 회복점수 예시:
  - 정상 로그인 10회 이상: +100
  - 관리자 인증 2회 이상: +200

### 5.2 AI 탐지 확률 예측 (LSTM 기반)

```
P(anomaly) = σ(Wx + b)
```

- σ: sigmoid 함수
- x: 다크데이터 입력 벡터 (클릭 좌표, 반응속도, 이동패턴)
- W, b: 학습된 파라미터

---

### 5.3 KARMA Score 계산 수식

**3.1.3 KARMA 시스템** 섹션 바로 뒤나, 해당 섹션 내에서 KARMA 점수 설명 아래에 추가합니다.

판단자의 행동은 KARMA 점수에 영향을 미치며, 특정 점수 이하 시 판단권이 제한됩니다.

```
KarmaScore = 초기값 + (Σ 올바른 판단점수) - (Σ 실책 점수)
```
- 초기값: 1000
- 최소 KARMA < 500 → Override 권한 일시 정지

---
## 6. 기존 보안 시스템과 JANUS-H 비교

| 항목 | 기존 시스템 | JANUS-H |
|------|--------------|----------|
| 판단 주체 | 시스템 또는 관리자 단독 | 수직 분산된 설계자 판단 |
| 로그 저장 | 일반 DB, 수정 가능 | 프라이빗 블록체인, 불변성 보장 |
| 인증 방식 | ID/PW, OTP 등 | 생체 인증 필수 |
| 격리 방식 | 없음 또는 단순 차단 | 디지털 트윈 기반 유사 환경 제공 |
| 이상 탐지 | 간단한 룰 기반 | AI 기반 + 환경 데이터 연동 |
| 내부자 대응 | 대응 어려움 | 유도 분석 후 설계자 판단 |

---

## 7. 용어 정리

| 용어 | 정의 |
|------|------|
| 설계자 | 시스템 침입 대응 및 판단 주체. 로그 접근, 격리 여부 등 결정 |
| Trust Score | 사용자 신뢰를 점수화하여 행동 기준 설정하는 시스템 |
| KARMA | 설계자 판단력에 대한 점수화 체계. 누적 평가 및 제한 가능 |
| 디지털 트윈 | 실제 환경을 가상으로 복제한 격리 공간 (Fake DB 포함) |
| Fake DB | 공격자 유인용 가짜 데이터베이스. 개인정보 가공 후 제공 |
| 다크데이터 | 사용자의 숨겨진 행동(클릭 좌표, 이동 경로, 반응속도 등) |
| Override 구조 | 판단 충돌 시, 상위 설계자가 하위 판단을 무효화하는 구조 |
| RAFT | 합의 알고리즘. 신뢰된 노드들 간 효율적인 블록체인 운영 지원 |
| 나노 센서 | 초소형 환경 센서. 온도/습도 등 변화 감지에 사용 |

---

## 8. 결론 및 향후 계획

- JANUS-H는 전통적 차단형 보안 아키텍처의 한계를 넘어,
  침입 이후를 설계 중심으로 유도/분석/격리/복구 가능한 구조로 설계됨
- 특히 인간 설계자 판단 중심의 보안 체계는 비판적 사고와 맥락 인식 기반의 방어를 가능하게 함
- 향후 프라이빗 블록체인, 생체 센서, AI 시스템의 실제 구현 시뮬레이션을 통해 적용 가능성 검증 예정

---
---

## 9. 고급 구조 설계 요소

### 9.1 Override 판단 충돌 예시

- **상황**: 중간 설계자(B)가 사용자 격리 해제 결정을 내림
- **상위 설계자(A)**가 이를 Override하여 격리 유지 결정

#### 판단 흐름 예시
1. 사용자 이상 탐지 → 격리 → B 설계자 판단
2. B: “Trust Score 회복됨, 복귀 허용”
3. A: “로그 검토 결과 조작 가능성 있음” → 복귀 취소, 격리 연장

- **로그 기록**:
  - `2025-05-30 11:03 | 설계자 B: 복귀 허용`
  - `2025-05-30 11:06 | 설계자 A: Override 발동 → 격리 유지`

---

### 9.2 설계자 등급제 및 판단 권한 구조

| 등급 | 권한 | 예시 역할 |
|------|------|-----------|
| L1 | Override 가능, 모든 로그 접근, 격리/복귀 최종 판단 | 최고 책임 설계자 (예: 사령관) |
| L2 | 격리/복귀 판단, 로그 열람, 일부 Override 제한 | 중간 관리자 (예: 작전장교) |
| L3 | 로그 분석, AI 리포트 확인, 격리 제안 | 보안 요원, AI 분석가 |

- **로그 접근 제한**: 상위 설계자만 특정 로그 접근 가능 (e.g., 설계자 Karma 로그)

---

### 9.3 Decoy Architect (가짜 설계자) 구조

- **개념**: 공격자가 설계자 계정 탈취 시, 의도적으로 가짜 권한 부여
- **동작 원리**:
  1. 탈취된 계정 → Decoy Architect 권한 부여
  2. 실제 로그 및 시스템에 접근하는 것처럼 보임
  3. 모든 활동 fake.db 및 디지털 트윈 상에서 이뤄짐
  4. 모든 행동 로그 정밀 수집 및 추적

- **목적**:
  - 공격자 식별
  - 법적 증거 수집
  - 실제 시스템 피해 방지

- **예시 로그**:
  ```
  [Decoy Architect] 2025-05-30 12:03 | 로그 #325 수정 시도
  [AI] 환경 불일치 감지 → 의심점수 +80
  ```

---

### 9.4 설계자 KARMA 점수 시스템

- **목적**: 설계자의 판단 신뢰성과 책임 추적
- **기준**:
  - 올바른 판단 시: +10 ~ +50
  - 잘못된 복귀 → 공격 발생 시: -100 이상
  - 판단 누락/지연: -30

#### KARMA Score 수식 예시

```
KarmaScore = 초기값 + (Σ 올바른 판단점수) - (Σ 실책 점수)
```

- 초기값: 1000
- 최소 KARMA < 500 → Override 권한 일시 정지

---

### 9.5 AI 리포트 자동화 및 다크데이터 분석

- **리포트 구조**:
  ```
  사용자: ID 1943
  로그인 위치: 192.168.0.14
  클릭 반응속도: 평균 180ms → 과거 대비 40ms 느림
  좌표 이동 패턴: 비정상 우회 클릭 경로
  판단: 의심 점수 87 / 100
  ```

- **기술적 요소**:
  - 클릭 좌표, 반응 시간, 이동 벡터 → LSTM 입력
  - 이상 탐지 확률 90% 이상 시 자동 알림

---

## 10. 전체 시스템 아키텍처 요약

```
┌───────────────────────────────────────────────┐
│ 사용자 행동 로그 수집 (클릭, IP, 생체, 환경) │
└───────────────────────────────────────────────┘
                ↓
┌────────────────────────────────┐
│ 블록체인 기반 로그 저장 (RAFT) │
└────────────────────────────────┘
                ↓
┌──────────────────────────────┐
│ AI 분석 및 Trust Score 계산 │
└──────────────────────────────┘
                ↓
┌────────────────────────────┐
│ 이상 탐지 시 디지털 트윈 격리 │
└────────────────────────────┘
                ↓
┌────────────────────────────────────────────┐
│ 설계자 판단: 복귀 / 격리 유지 / 봉쇄 / Override │
└────────────────────────────────────────────┘
                ↓
┌────────────────────────────────┐
│ 로그 추적 + KARMA 점수 누적 기록 │
└────────────────────────────────┘
```

---
---

## 11. 다크데이터(Dark Data) 필드 구조 설계

- **정의**: 일반 로그 외 감지되지 않는 행동/패턴 데이터 (e.g. 마우스 이동 궤적, 반응 시간, 입력 취소 이력 등)
- **목적**: 공격자 특성 파악, 고급 AI 분석, 판단 보조

### 필드 예시

| 필드명 | 설명 | 예시 |
|--------|------|------|
| cursor_path | 마우스 이동 궤적 벡터 좌표 | [(120,340), (122,344), (150,370)...] |
| reaction_delay | 버튼 클릭 반응 시간(ms) | 230ms |
| input_cancel_count | 입력 취소 횟수 (Backspace 포함) | 7회 |
| hover_duration | 특정 요소 위에 머문 시간 | 3.4초 |
| key_input_pattern | 키 입력 시퀀스 패턴 | ["s", "e", "c", "Backspace", "s", "e", "c"] |

---

## 12. 설계자 판단 UI 프로토타입

- **목표**: 설계자 판단 인터페이스 명확화
- **구성**:
  - 사용자 로그 목록
  - AI 리포트 및 Trust Score 시각화
  - 격리/복귀/Override 옵션 버튼
  - 다크데이터 요약

### 인터페이스 예시 (텍스트 기반)

```
┌──────────────────────────────┐
│ 사용자: ID 1943             │
│ Trust Score: 470/1000       │
│ AI Risk Level: ★★★★☆        │
│ 로그 요약: 로그인 시도 3회, 좌표 이상 2건 │
│ 환경 로그: 2025-05-30 15:04 (27°C, 65%)  │
│ 판단 로그: 격리됨 → 2025-05-30 15:05     │
├──────────────────────────────┤
│ [복귀 허용] [격리 유지] [Override 요청]  │
└──────────────────────────────┘
```

---

## 13. 시뮬레이션 및 벤치마크 예시

### A. 시뮬레이션 시나리오

- **조건**:
  - 사용자 100명 중 5명 이상행동 (Trust Score < 600)
  - 3명은 실제 공격자 (로그 조작 + 환경 위조 시도)

- **목표**:
  - 이상 탐지 정확도, 격리 정확도, 로그 무결성 테스트

### B. 결과 예시

| 항목 | 목표치 | 실제 결과 |
|------|--------|-----------|
| 이상 탐지율 (AI) | ≥90% | 91.3% |
| 격리 정확도 | ≥85% | 87.5% |
| 블록체인 해시 충돌 탐지율 | 100% | 100% |
| Decoy Architect 유도 성공률 | ≥80% | 85.2% |

---

## 14. 일반 보안 시스템과 JANUS-H 비교 (총정리)

| 항목 | 기존 보안 시스템 | JANUS-H |
|------|------------------|---------|
| 접근 제어 | 비밀번호 기반 | 생체 + 로그 기반 |
| 이상 탐지 | 일반 패턴 분석 | AI + 다크데이터 기반 |
| 로그 무결성 | 중앙 저장 / 수정 가능 | 블록체인 기반 불변성 |
| 침입 대응 | 차단 위주 | 유도 → 격리 → 복귀 판단 |
| 설계자 판단 | 없음 (자동 처리) | 인간 중심 수직 판단 체계 |
| 복귀 시스템 | 없음 또는 자동화 | Override 기반 설계자 승인 필요 |
| 내부자 대응 | 제한적 | 설계자 KARMA + 샌드박스 + Fake DB |

---


